---
title: 'Lab 1: Question 3'
author: "Jun Qian, Lucas Schroyer, Ryan Mitchell, Oliver Chang"
output: pdf_document
---

```{r load packages, echo=TRUE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2) 
library(tidyverse) # if you want more, but still core, toolkit
```

```{r load and clean data, echo=FALSE, warning=TRUE, message=FALSE}
anes_timeseries_raw3_0 <- readRDS(file = "Data/anes_key_fields_forQ3.rds") %>% 
  select(id, 
         gov_approval_covid_response,# = V201145, Main Variable
         gov_approval_covid_response2,# = V201146, Main Variable
         voted_for_governor,# = V201066, Potential Secondary Variable
         voted_for_governor2,# = V201067, Potential Secondary Variable
         voted_for_governor3,# = V201070, Potential Secondary Variable
         voted_for_governor4,# = V201073,Potential Secondary Variable
         covid_household_tested,# = V201624, Main Variable
         covid_household_suspected)# = V201625, Main Variable

anes_timeseries_raw3_0 %>% glimpse()

#DATA CLEANING HERE

#END DATA CLEANING
anes_timeseries_raw3 <- anes_timeseries_raw3_0

anes_timeseries_raw3 %>% count(gov_approval_covid_response)
anes_timeseries_raw3 %>% count(gov_approval_covid_response2)

anes_timeseries_raw3 %>% 
  count(gov_approval_covid_response, gov_approval_covid_response2) %>% 
  arrange(desc(gov_approval_covid_response), desc(gov_approval_covid_response2))


# Create a Likert Variable from two variables measuring approval/disapproval and degree of approval/disapproval.
anes_timeseries_q3 <- anes_timeseries_raw3 %>%
  mutate(gov_approval_covid_response_new = case_when(
    gov_approval_covid_response == 2 & gov_approval_covid_response2 == 1 ~ 1, #“Strongly Disapprove”
    gov_approval_covid_response == 2 & gov_approval_covid_response2 == 2 ~ 2, #“Not Strongly Disapprove”
    gov_approval_covid_response == 1 & gov_approval_covid_response2 == 2 ~ 3, #“Not Strongly Approve”
    gov_approval_covid_response == 1 & gov_approval_covid_response2 == 1 ~ 4, #“Strongly Approve”
    T ~ 99
  )) %>%
# Recode the Disapprove (2) and Approve (1) values to binary
  mutate(gov_approval_covid_response_binary = case_when(
    gov_approval_covid_response == 1 ~ 1,
    gov_approval_covid_response == 2 ~ 0,
    T ~ 99
  ))


# anes_timeseries_q3 <- anes_timeseries_raw3 %>% 
#   mutate(gov_approval_covid_response_new = case_when(
#     gov_approval_covid_response == 1 & gov_approval_covid_response2 == 1 ~ "Strongly Approve",
#     gov_approval_covid_response == 2 & gov_approval_covid_response2 == 1 ~ "Strongly Disapprove",
#     gov_approval_covid_response == 1 & gov_approval_covid_response2 == 2 ~ "Not Strongly Approve",
#     gov_approval_covid_response == 2 & gov_approval_covid_response2 == 2 ~ "Not Strongly Disapprove",
#     T ~ "Other"
#   ))

anes_timeseries_q3 %>% 
  count(gov_approval_covid_response_new) %>% 
  rename(count = n) %>% 
  arrange(desc(count)) %>% 
  mutate(freq = round(count/sum(count)*100,2))



```


## Importance and Context
<!-- You can (and should delete each of these comments lines in your final report) --> 
<!-- Explain why the reader should care about your research question. -->

3. Are survey respondents who have had someone in their home infected by COVID-19 more likely to disapprove of the way their governor is handling the pandemic?

V201145
PRE: APPROVE OR DISAPPROVE R’S GOVERNOR
HANDLING COVID-19
1. Approve
2. Disapprove
-8. Don’t know
-9. Refused

V201146
PRE: HOW MUCH APPROVE/DISAPPROVE R’S
GOVERNOR HANDLING COVID-19
1. Strongly
2. Not strongly
-1. Inapplicable
-8. Don’t know
-9. Refused


## Description of Data
<!-- Explain how your research question is operationalized, including whether the variables you create are appropriate to study the concepts in question. --> 
<!-- What are some basic features of the data distribution? --> 
<!-- What changes do you make to the data and why? --> 

## Most appropriate test 
<!-- Explain which test is the most appropriate to answer your question and why it is the most appropriate --> 
<!-- List every assumption that your test requires and evaluate it. -->

Liekhert - independent samples non parametric (Wilcoxon rank)

Does the order matter? e.g. strongly disapprove ... strongly approve vs strongly approve ... strongly disapprove


## Test, results and interpretation
<!-- What are the results of your test? --> 
<!-- What do the results of this test mean? What is the practical significance? --> 